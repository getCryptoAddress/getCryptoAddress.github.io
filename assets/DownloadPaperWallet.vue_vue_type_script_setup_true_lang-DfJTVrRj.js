import{d as fe,_ as X,b as pe}from"./index-DdwbUJkS.js";import{k,z as y,D as S,B as L,r as w,f as M,av as C,A as P,n as oe,M as me,w as ve,I as H,ab as ge,ad as ae,E as A,K as $,H as E,u as T,a5 as J,L as re,P as z,S as ie,R as he,v as we,aw as be,J as ye,Z as _e,an as xe,ao as Te,T as Ie}from"./naive-ui-BEIEYFMM.js";import{c as B,g as V,i as Ee,d as Se}from"./index-Cq0ehnbf.js";import{_ as $e}from"./DonationList-pthR99rC.js";const Me={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},ke=L("g",{fill:"none"},[L("path",{d:"M3.5 13h9a.5.5 0 0 1 .09.992L12.5 14h-9a.5.5 0 0 1-.09-.992L3.5 13h9h-9zM7.91 1.008L8 1a.5.5 0 0 1 .492.41l.008.09v8.792l2.682-2.681a.5.5 0 0 1 .638-.058l.07.058a.5.5 0 0 1 .057.638l-.058.069l-3.535 3.536a.5.5 0 0 1-.638.057l-.07-.057l-3.535-3.536a.5.5 0 0 1 .638-.765l.069.058L7.5 10.292V1.5a.5.5 0 0 1 .41-.492L8 1l-.09.008z",fill:"currentColor"})],-1),Oe=[ke],se=k({name:"ArrowDownload16Regular",render:function(t,n){return y(),S("svg",Me,Oe)}});function Le(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Q=Le,De=typeof B=="object"&&B&&B.Object===Object&&B,Pe=De,Ce=Pe,je=typeof self=="object"&&self&&self.Object===Object&&self,Re=Ce||je||Function("return this")(),le=Re,We=le,Ne=function(){return We.Date.now()},ze=Ne,Be=/\s/;function Ae(e){for(var t=e.length;t--&&Be.test(e.charAt(t)););return t}var Fe=Ae,Ge=Fe,Ue=/^\s+/;function He(e){return e&&e.slice(0,Ge(e)+1).replace(Ue,"")}var Xe=He,Ve=le,Qe=Ve.Symbol,ue=Qe,K=ue,de=Object.prototype,Ye=de.hasOwnProperty,Je=de.toString,N=K?K.toStringTag:void 0;function Ke(e){var t=Ye.call(e,N),n=e[N];try{e[N]=void 0;var a=!0}catch{}var s=Je.call(e);return a&&(t?e[N]=n:delete e[N]),s}var Ze=Ke,qe=Object.prototype,et=qe.toString;function tt(e){return et.call(e)}var nt=tt,Z=ue,ot=Ze,at=nt,rt="[object Null]",it="[object Undefined]",q=Z?Z.toStringTag:void 0;function st(e){return e==null?e===void 0?it:rt:q&&q in Object(e)?ot(e):at(e)}var lt=st;function ut(e){return e!=null&&typeof e=="object"}var dt=ut,ct=lt,ft=dt,pt="[object Symbol]";function mt(e){return typeof e=="symbol"||ft(e)&&ct(e)==pt}var vt=mt,gt=Xe,ee=Q,ht=vt,te=NaN,wt=/^[-+]0x[0-9a-f]+$/i,bt=/^0b[01]+$/i,yt=/^0o[0-7]+$/i,_t=parseInt;function xt(e){if(typeof e=="number")return e;if(ht(e))return te;if(ee(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ee(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=gt(e);var n=bt.test(e);return n||yt.test(e)?_t(e.slice(2),n?2:8):wt.test(e)?te:+e}var Tt=xt,It=Q,U=ze,ne=Tt,Et="Expected a function",St=Math.max,$t=Math.min;function Mt(e,t,n){var a,s,p,f,u,m,c=0,l=!1,g=!1,h=!0;if(typeof e!="function")throw new TypeError(Et);t=ne(t)||0,It(n)&&(l=!!n.leading,g="maxWait"in n,p=g?St(ne(n.maxWait)||0,t):p,h="trailing"in n?!!n.trailing:h);function _(i){var d=a,o=s;return a=s=void 0,c=i,f=e.apply(o,d),f}function b(i){return c=i,u=setTimeout(x,t),l?_(i):f}function j(i){var d=i-m,o=i-c,v=t-d;return g?$t(v,p-o):v}function O(i){var d=i-m,o=i-c;return m===void 0||d>=t||d<0||g&&o>=p}function x(){var i=U();if(O(i))return I(i);u=setTimeout(x,j(i))}function I(i){return u=void 0,h&&a?_(i):(a=s=void 0,f)}function D(){u!==void 0&&clearTimeout(u),c=0,a=m=s=u=void 0}function R(){return u===void 0?f:I(U())}function r(){var i=U(),d=O(i);if(a=arguments,s=this,m=i,d){if(u===void 0)return b(m);if(g)return clearTimeout(u),u=setTimeout(x,t),_(m)}return u===void 0&&(u=setTimeout(x,t)),f}return r.cancel=D,r.flush=R,r}var ce=Mt;const kt=V(ce);function Ot(e){return new Promise(t=>{const n=new Image;n.onload=function(){t({width:n.width,height:n.height,src:e})},n.src=e})}const un=fe("paperWallet",()=>{const e=kt(d,200,{leading:!0,trailing:!1}),t=w([]);function n(o){e(),t.value=[...o]}function a(o){e(),t.value=t.value.map(v=>v.id===o.id?o:v)}function s(o){e(),t.value=t.value.filter(v=>v.id!==o.id)}function p(o){const v=t.value.findIndex(G=>G.id===o.id);if(v===0)return;e();const W=t.value[v-1];t.value[v-1]=o,t.value[v]=W}function f(o){const v=t.value.findIndex(G=>G.id===o.id);if(v===t.value.length-1)return;e();const W=t.value[v+1];t.value[v+1]=o,t.value[v]=W}async function u(o="Text"){const v={id:`${Date.now()}`,font:"Courier New",type:"TEXT",text:o,align:"center",alignLast:"auto",color:"#333333FF",size:16,weight:400,position:{x:10,y:10,width:300,rotate:0,transformOrigin:"center center"}};e(),t.value.push(v)}async function m(o=""){const{width:v}=await Ot(o),W={id:`${Date.now()}`,type:"IMAGE",src:o,position:{x:0,y:0,width:v,rotate:0,transformOrigin:"center center"}};e(),t.value.push(W)}async function c(o="QrCode"){const v={id:`${Date.now()}`,type:"QR_CODE",text:o,color:"#000000FF",background:"#00000000",position:{x:0,y:0,width:100,rotate:0,transformOrigin:"center center"}};e(),t.value.push(v)}const l=M(()=>[...t.value].reverse());function g(o){n([...o].reverse())}const h=w("EDIT");function _(o){h.value=o}const b=w(null),j=M(()=>t.value.find(o=>o.id===b.value)||null);function O(o){if(!o){b.value=null;return}b.value=o.id}const x=w([]),I=w([]);function D(){if(!x.value.length)return;const o=x.value.splice(-1)[0];o&&(I.value.push(t.value),t.value=o)}function R(){if(!I.value.length)return;const o=I.value.splice(-1)[0];o&&(x.value.push(t.value),t.value=o)}function r(){for(;x.value.length>=15;)x.value.shift();x.value.push([...t.value])}function i(){I.value=[]}function d(){r(),i()}return{items:t,canvasMode:h,selectedItemId:b,undoStack:x,redoStack:I,selectedItem:j,revertedItems:l,setItems:n,setRevertedItems:g,updateItem:a,addItemText:u,addItemImage:m,addItemQRCode:c,removeItem:s,moveItemUp:f,moveItemDown:p,setCanvasMode:_,setSelectItem:O,undo:D,redo:R}}),Lt=["src"],Dt=k({__name:"PaperWalletCanvasImage",props:{item:{}},emits:["load"],setup(e,{emit:t}){const n=t,a=e,s=M(()=>({cursor:"move",position:"absolute",left:a.item.position.x+"px",top:a.item.position.y+"px",width:a.item.position.width+"px",overflowWrap:"anywhere",userSelect:"none",transform:`rotate(${a.item.position.rotate}deg)`,transformOrigin:a.item.position.transformOrigin}));return(p,f)=>(y(),S("img",{src:p.item.src,alt:"",draggable:"false",style:C(s.value),decoding:"sync",onLoad:f[0]||(f[0]=u=>n("load",p.item))},null,44,Lt))}}),Pt=k({__name:"PaperWalletCanvasQrCode",props:{item:{}},setup(e){const t=e,n=M(()=>({cursor:"move",position:"absolute",left:t.item.position.x+"px",top:t.item.position.y+"px",width:t.item.position.width+"px",overflowWrap:"anywhere",userSelect:"none",transform:`rotate(${t.item.position.rotate}deg)`,transformOrigin:t.item.position.transformOrigin,lineHeight:0}));return(a,s)=>(y(),P($e,{text:a.item.text,width:a.item.position.width,style:C(n.value),background:a.item.background,color:a.item.color},null,8,["text","width","style","background","color"]))}}),Ct=["innerHTML"],jt=["innerHTML"],Rt="plaintext-only",Wt=k({__name:"PaperWalletCanvasText",props:{item:{}},emits:["updateText"],setup(e,{emit:t}){const n=e,a=t,s=M(()=>({cursor:"move",position:"absolute",fontFamily:n.item.font,fontSize:n.item.size+"px",fontWeight:n.item.weight,textAlign:n.item.align,textAlignLast:n.item.alignLast,color:n.item.color,left:n.item.position.x+"px",top:n.item.position.y+"px",width:n.item.position.width+"px",overflowWrap:"anywhere",userSelect:"none",transform:`rotate(${n.item.position.rotate}deg)`,transformOrigin:n.item.position.transformOrigin,lineHeight:"normal"})),p=w(),f=w(!1),u=w(""),m=M(()=>n.item.text.replace(/\n/g,"<br>"));function c(h){const _=h.target?.textContent||"";a("updateText",_)}function l(){f.value=!0,u.value=n.item.text,oe(()=>{const h=p.value;if(!h)return;h.focus();const _=document.createRange();_.selectNodeContents(h),_.collapse(!1);const b=window.getSelection();b&&(b.removeAllRanges(),b.addRange(_))})}function g(){f.value=!1}return(h,_)=>f.value?(y(),S("div",{key:1,contenteditable:Rt,onBlur:g,onInput:c,style:C(s.value),ref_key:"editRef",ref:p,innerHTML:u.value,class:"paper-wallet-canvas-text__editable"},null,44,jt)):(y(),S("div",{key:0,onDblclick:l,style:C(s.value),innerHTML:m.value},null,44,Ct))}}),Nt=X(Wt,[["__scopeId","data-v-9e6e5f04"]]),zt=k({__name:"PaperWalletCanvas",props:{items:{},view:{},isEditMode:{type:Boolean},selectedItemId:{}},emits:["updateItem","select","load"],setup(e,{expose:t,emit:n}){const a=n,s=e,p=w(null);let f=!1,u=null,m=0,c=0;function l(r,i){s.isEditMode&&(f=!0,u=r,a("select",r),m=r.position.x-i.clientX,c=r.position.y-i.clientY,addEventListener("mouseup",g))}function g(){f=!1,u=null,removeEventListener("mouseup",g)}function h(r,i){!s.isEditMode||i.touches.length>1||(f=!0,u=r,a("select",r),m=r.position.x-i.touches[0].clientX,c=r.position.y-i.touches[0].clientY,addEventListener("touchend",b),addEventListener("touchcancel",b))}function _(r){if(!f||!u||r.touches.length>1)return;r.preventDefault();const i=O(m+r.touches[0].clientX,c+r.touches[0].clientY,u);a("updateItem",i)}function b(){f=!1,u=null,removeEventListener("touchend",b),removeEventListener("touchcancel",b)}me(()=>{removeEventListener("mouseup",g),removeEventListener("touchend",b),removeEventListener("touchcancel",b)});function j(r){if(!f||!u)return;const i=O(m+r.clientX,c+r.clientY,u);a("updateItem",i)}function O(r,i,d){return{...d,position:{...d.position,x:r,y:i}}}function x(r,i){const d={...r,text:i};a("updateItem",d)}const I=w([]),D=M(()=>new Set(s.items.filter(r=>r.type==="IMAGE").map(r=>r.id)));function R(r){I.value=[...I.value,r.id].filter(i=>D.value.has(i))}return ve(()=>p.value&&I.value.length===D.value.size,r=>{r&&a("load")},{immediate:!0}),t({targetElement:p}),(r,i)=>(y(),S("div",{class:ae(["paper-wallet-canvas",{"paper-wallet-canvas--edit-mode":r.view==="EDIT","paper-wallet-canvas--print-mode":r.view==="PRINT"}]),onMousemove:j,onTouchmove:_,ref_key:"targetElement",ref:p,"data-test-el":"paper-wallet-canvas"},[(y(!0),S(H,null,ge(r.items,d=>(y(),S(H,{key:d.id},[d.type==="TEXT"?(y(),P(Nt,{key:0,item:d,onMousedown:o=>l(d,o),onTouchstart:o=>h(d,o),onUpdateText:o=>x(d,o),"data-selected-item":r.selectedItemId===d.id},null,8,["item","onMousedown","onTouchstart","onUpdateText","data-selected-item"])):A("",!0),d.type==="IMAGE"?(y(),P(Dt,{key:1,item:d,"data-selected-item":r.selectedItemId===d.id,onMousedown:o=>l(d,o),onTouchstart:o=>h(d,o),onLoad:R},null,8,["item","data-selected-item","onMousedown","onTouchstart"])):d.type==="QR_CODE"?(y(),P(Pt,{key:2,item:d,onMousedown:o=>l(d,o),onTouchstart:o=>h(d,o),"data-selected-item":r.selectedItemId===d.id},null,8,["item","onMousedown","onTouchstart","data-selected-item"])):A("",!0)],64))),128))],34))}}),Bt=X(zt,[["__scopeId","data-v-7862aedc"]]),At=k({__name:"PaperWalletDownloadForm",props:{loading:{type:Boolean}},emits:["submit"],setup(e,{emit:t}){const n=t,a=w("PNG"),s=w("PRINT"),p=[{label:"Download as PNG",value:"PNG"},{label:"Download as JPEG",value:"JPEG"}],f=[{label:"Print Mode",value:"PRINT"},{label:"Preview Mode",value:"VIEW"},{label:"Edit Mode",value:"EDIT"}];async function u(){n("submit",{typeOfDownload:a.value,canvasMode:s.value})}return(m,c)=>(y(),P(T(he),null,{default:$(()=>[E(T(J),{trigger:"hover",options:p,value:a.value,"onUpdate:value":c[0]||(c[0]=l=>a.value=l),"consistent-menu-width":!1,style:{minWidth:"170px"}},null,8,["value"]),E(T(J),{trigger:"hover",options:f,value:s.value,"onUpdate:value":c[1]||(c[1]=l=>s.value=l),"consistent-menu-width":!1,style:{minWidth:"170px"}},null,8,["value"]),E(T(ie),{loading:m.loading,onClick:u},{icon:$(()=>[E(T(re),null,{default:$(()=>[E(T(se))]),_:1})]),default:$(()=>[c[2]||(c[2]=z(" Download "))]),_:1},8,["loading"])]),_:1}))}});var Ft=ce,Gt=Q,Ut="Expected a function";function Ht(e,t,n){var a=!0,s=!0;if(typeof e!="function")throw new TypeError(Ut);return Gt(n)&&(a="leading"in n?!!n.leading:a,s="trailing"in n?!!n.trailing:s),Ft(e,t,{leading:a,maxWait:t,trailing:s})}var Xt=Ht;const Vt=V(Xt),Qt={class:"resizable-paper-wallet-wrapper"},Yt=k({__name:"ResizablePaperWalletWrapper",props:{bordered:{type:Boolean}},setup(e){const t=w(),n=pe(),a=w(1),s=w("auto"),p=e,f=M(()=>({"resizable-paper-wallet-wrapper__container":!0,"resizable-paper-wallet-wrapper__bordered":p.bordered,"resizable-paper-wallet-wrapper__bordered--dark":p.bordered&&n.value}));function u(c){return Math.max(0,...[...c.children].map(l=>l instanceof HTMLDivElement?l.offsetWidth:0))}const m=Vt(()=>{if(!t.value){console.error("Container not found");return}const c=u(t.value);if(!c)return;const l=t.value.offsetWidth/c;a.value=l<1?l:1,s.value=`${t.value.offsetHeight*a.value}px`},100);return we(()=>{window.addEventListener("resize",m),m()}),be(()=>{window.removeEventListener("resize",m)}),(c,l)=>(y(),S("div",Qt,[L("div",{ref:"container",class:ae(f.value),style:C({height:s.value})},[L("div",{class:"resizable-paper-wallet-wrapper__area",ref_key:"area",ref:t,style:C({transform:`scale(${a.value})`})},[ye(c.$slots,"default",{},void 0,!0)],4)],6)]))}}),dn=X(Yt,[["__scopeId","data-v-c8e123f2"]]);var F={exports:{}};F.exports=Y;F.exports.isMobile=Y;F.exports.default=Y;const Jt=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser.*mobile|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,Kt=/CrOS/,Zt=/android|ipad|playbook|silk/i;function Y(e){e||(e={});let t=e.ua;if(!t&&typeof navigator<"u"&&(t=navigator.userAgent),t&&t.headers&&typeof t.headers["user-agent"]=="string"&&(t=t.headers["user-agent"]),typeof t!="string")return!1;let n=Jt.test(t)&&!Kt.test(t)||!!e.tablet&&Zt.test(t);return!n&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&t.indexOf("Macintosh")!==-1&&t.indexOf("Safari")!==-1&&(n=!0),n}var qt=F.exports;const en=V(qt),tn={key:0},nn={key:0,style:{position:"fixed",overflow:"hidden",display:"grid",width:"0",height:"0",top:"0",left:"0"}},on={style:{overflow:"scroll"}},cn=k({__name:"DownloadPaperWallet",props:{items:{}},setup(e){const t=_e(),n=w(),a=w(!1),s=w(!1),p=w("PNG"),f=w("PRINT"),u=Ee();async function m(l){f.value=l.canvasMode,p.value=l.typeOfDownload,s.value=!0}async function c(){await oe(),await new Promise(l=>setTimeout(l,en()?500:1));try{let l=n.value?.targetElement;if(!l){s.value=!1,t.error("Problem with canvas element");return}await Se(l,p.value,"paper-wallet",!0)}catch(l){t.error(typeof l=="string"?l:"Something went wrong")}finally{s.value=!1}}return(l,g)=>(y(),S(H,null,[E(T(ie),{onClick:g[0]||(g[0]=h=>a.value=!a.value)},{icon:$(()=>[E(T(re),null,{default:$(()=>[E(T(se))]),_:1})]),default:$(()=>[g[2]||(g[2]=z(" Download Image "))]),_:1}),E(T(Te),{show:a.value,"onUpdate:show":g[1]||(g[1]=h=>a.value=h),height:320,placement:"bottom"},{default:$(()=>[E(T(xe),{title:"Download paper wallet",closable:""},{default:$(()=>[E(T(At),{loading:s.value,onSubmit:m},null,8,["loading"]),T(u)?(y(),S("p",tn,g[3]||(g[3]=[z(" NB: "),L("strong",null,"IOS",-1),z(" and "),L("strong",null,"Safari",-1),z(" may not render images as expected the first time. If you encounter with current problem, just try downloading the image a second time. ")]))):A("",!0)]),_:1})]),_:1},8,["show"]),(y(),P(Ie,{to:"body"},[s.value?(y(),S("div",nn,[L("div",on,[E(T(Bt),{items:l.items,view:f.value,onLoad:c,ref_key:"canvasEl",ref:n},null,8,["items","view"])])])):A("",!0)]))],64))}});export{Bt as P,dn as R,cn as _,un as u};
